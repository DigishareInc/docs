---
title: الرسائل الصادرة
description: مرجع مفصل لإرسال الرسائل النصية والموقع والرسائل التفاعلية عبر API.
icon: i-lucide-send
---

::warning
**المتطلبات الأساسية**: يجب أن يكون لديك معرف محادثة نشط للرد على المستخدم. انظر [تكامل LiveChat](/developer-guides/livechat/integration).
::

## 1. غلاف الرسالة (Message Envelope)

يستخدم كل طلب API هذا الهيكل القياسي.

| الحقل             | النوع         | الوصف                                                    |
| :---------------- | :------------ | :------------------------------------------------------- |
| `send_to_third`   | Boolean       | اضبطه على `true` للتسليم عبر منصة خارجية (مثل WhatsApp). |
| `conversation_id` | String        | معرف فريد لجلسة الدردشة.                                 |
| `type`            | String        | تنسيق الرسالة: `text` أو `location` أو `interactive`.    |
| `body`            | String/Object | محتوى الـ payload (يختلف حسب النوع).                     |

## 2. الرسائل النصية

تواصل نصي بسيط. الـ `body` عبارة عن **سلسلة نصية (string)**.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "send_to_third": true,
    "conversation_id": "YOUR_CONVERSATION_ID",
    "type": "text",
    "body": "مرحباً عادل! طلبك جاهز."
  }'
```

::

## 3. رسائل الموقع

إرسال دبوس خريطة ثابت.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "send_to_third": true,
    "conversation_id": "YOUR_CONVERSATION_ID",
    "type": "location",
    "body": {
      "latitude": 33.5731,
      "longitude": -7.5898,
      "name": "مقر Digishare",
      "address": "الدار البيضاء، المغرب"
    }
  }'
```

::

## 4. الرسائل التفاعلية

رسائل منظمة لتعزيز التفاعل.

::accordion
::accordion-item{label="أزرار الرد" icon="i-lucide-mouse-pointer-2"}
أفضل للتأكيدات السريعة (نعم/لا). الحد الأقصى 3 أزرار.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "interactive",
    "body": {
      "type": "button",
      "header": { "type": "text", "text": "تأكيد" },
      "body": { "text": "هل تؤكد الاستلام؟" },
      "action": {
        "buttons": [
          { "type": "reply", "reply": { "id": "btn_yes", "title": "نعم" } },
          { "type": "reply", "reply": { "id": "btn_no", "title": "لا" } }
        ]
      }
    }
  }'
```

::

::accordion-item{label="قائمة الخيارات" icon="i-lucide-list"}
أفضل للخيارات المتعددة (حتى 10 صفوف).

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "interactive",
    "body": {
      "type": "list",
      "header": { "type": "text", "text": "قائمة الدعم" },
      "body": { "text": "اختر فئة أدناه:" },
      "action": {
        "button": "اختر خياراً",
        "sections": [
          {
            "title": "الدعم الفني",
            "rows": [
              {
                "id": "row_1",
                "title": "مشاكل API",
                "description": "مساعدة في التكامل"
              },
              { "id": "row_2", "title": "تسجيل الدخول", "description": "الوصول للحساب" }
            ]
          }
        ]
      }
    }
  }'
```

::

::accordion-item{label="طلب الموقع" icon="i-lucide-map-pin"}
يشغل واجهة "إرسال الموقع" الأصلية.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "interactive",
    "body": {
      "type": "location_request_message",
      "body": { "text": "يرجى مشاركة موقعك الحالي." },
      "action": { "name": "send_location" }
    }
  }'
```

::
::

## 5. القيود (Constraints)

| النوع         | المكون          | الحد     |
| :------------ | :-------------- | :------- |
| **النص**      | `body`          | 4096 حرف |
| **التفاعلية** | `header`        | 60 حرف   |
| **التفاعلية** | عنوان `button`  | 20 حرف   |
| **التفاعلية** | عنوان صف `list` | 24 حرف   |
