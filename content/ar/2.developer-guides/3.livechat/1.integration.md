---
title: تكامل LiveChat
description: تمكين التواصل في الوقت الفعلي من خلال دمج نظامك مع Digishare LiveChat.
icon: i-lucide-message-circle
---

يوضح هذا الدليل التكامل الفني مع نظام Digishare LiveChat. التكامل ثنائي الاتجاه:

1.  **Webhooks**: يستمع نظامك للأحداث في الوقت الفعلي (محادثات جديدة، رسائل واردة).
2.  **API**: يرسل نظامك الردود مرة أخرى إلى المستخدم عبر Digishare API.

::note
تأكد من أن لديك **رمز الوصول** الخاص بك جاهزاً. انظر [المصادقة](/developer-guides/authentication) للحصول على التفاصيل.
::

## 1. Webhooks

يجب أن يكشف نظامك عن نقطة نهاية **POST** لتلقي payloads الأحداث من Digishare.

### الأحداث (Events)

::accordion
::accordion-item{label="محادثة جديدة" icon="i-lucide-plus"}
**الحدث**: `live_chat.new_conversation`

يتم تشغيله عندما يبدأ المستخدم محادثة جديدة. استخدم `data.id` (معرف المحادثة) لإرسال الردود.

**Payload:**

```json
{
  "event": "live_chat.new_conversation",
  "data": {
    "id": "YOUR_CONVERSATION_ID",
    "data": {
      "created_at": "2025-12-03T12:28:50.000000Z",
      "third": {
        "id": "YOUR_THIRD_ID",
        "name": "Adil Chbada"
      }
    }
  }
}
```

::

::accordion-item{label="رسالة واردة" icon="i-lucide-arrow-down-left"}
**الحدث**: `live_chat.new_message`

يتم تشغيله عندما يرسل العميل رسالة.

**Payload:**

```json
{
  "event": "live_chat.new_message",
  "data": {
    "id": "YOUR_MESSAGE_ID",
    "data": {
      "conversation_id": "YOUR_CONVERSATION_ID",
      "body": "/info",
      "sender": {
        "model_type": "third",
        "name": "Adil Chbada"
      }
    }
  }
}
```

::
::

## 2. إرسال الرسائل

للرد على العميل، قم بتقديم طلب `POST` إلى نقطة نهاية الرسائل. للحصول على مرجع مفصل حول إرسال أنواع مختلفة من الرسائل (نص، موقع، تفاعلي)، انظر [الرسائل الصادرة](/developer-guides/livechat/outgoing-messages).

**Point de terminaison**: `POST https://api.digishare.ma/v1/messages`

::steps

### إعداد Payload

قم ببناء جسم JSON يحتوي على محتوى الرسالة ومعرف المحادثة المستهدف.

### إرسال الطلب

أرسل الطلب مع رمز Bearer الخاص بك.

### التحقق

تأكد من تلقي استجابة `200 OK` أو `201 Created`.
::

### جسم الطلب (Request Body)

| المعلمة (Parameter) | النوع   | مطلوب   | الوصف                                                      |
| :------------------ | :------ | :------ | :--------------------------------------------------------- |
| `body`              | String  | **نعم** | المحتوى النصي للرسالة.                                     |
| `conversation_id`   | String  | **نعم** | المعرف من حدث webhook.                                     |
| `send_to_third`     | Boolean | **نعم** | اضبطه على `true` للتسليم إلى منصة المستخدم (مثل WhatsApp). |

### مثال

::code-group

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "body": "مرحباً! كيف يمكنني مساعدتك؟",
    "conversation_id": "YOUR_CONVERSATION_ID",
    "send_to_third": true
  }'
```

::
