---
title: E-Commerce Integration
description: Automate order notifications, support tickets, and marketing for your online store.
icon: i-lucide-shopping-cart
---

This document outlines the workflow for integrating an **eCommerce application** with the Digishare Platform. This enables automated customer support, order tracking notifications, and targeted marketing campaigns.

::note
**Prerequisite**: Ensure you have authenticated your client. See [Authentication](/developer-guides/authentication).
::

## 1. Workflow Overview

::steps

### Upload Media

(Optional) Upload any necessary files (PDFs, Images) to get their IDs.

### Ticket Creation

Your eCommerce app creates a ticket when an order issue arises or confirmation is needed.

### Automated Notification

Digishare automatically triggers a WhatsApp notification to the customer.

### Webhook Sync

Digishare notifies your eCommerce app via webhook to update the order status.
::

## 2. Upload Media

**Endpoint**: `POST https://api.digishare.ma/v1/messagesTemplates`

Before creating a ticket with an attachment (like an invoice PDF), you must upload the file to Digishare to get a `media_id`.

::code-group

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messagesTemplates \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "type": "file",
    "category": "document",
    "file": {
      "base64": "data:application/pdf;base64,JVBERi0xLjQKJ...",
      "file_name": "invoice",
      "mime_type": "application/pdf"
    }
  }'
```

::

> **Response**: Save the returned `id` (e.g., `YOUR_MEDIA_ID`). Use this as the `PRE_UPLOADED_HASHED_ID` in the next step.

## 3. Creating Tickets

**Endpoint**: `POST https://api.digishare.ma/v1/tickets`

Create a ticket to initiate the support flow. You can map external IDs (like Order ID) to the ticket.

### Request Body

```json
{
  "external_id": "ORDER-12345",
  "type_ticket_id": "npvrxamq9l94y8dz",
  "ticket_status_id": "x9q3wrlv0m7vzea8",
  "create_third_data": true,
  "information": {
    "third": {
      "ext_ref": "CUSTOMER-67890",
      "name": "Ahmed Alami",
      "wa_id": "212600000000",
      "email": "ahmed.alami@example.com"
    },
    "campaign_data": {
      "order_id": "12345",
      "invoice_document": {
        "provider": "digishare",
        "id": "PRE_UPLOADED_HASHED_ID"
      },
      "items_count": "5",
      "order_total": "500.00",
      "delivery_address": "Casablanca, Bd Zerktouni"
    }
  },
  "subject": "Order Confirmation",
  "lang": "fr"
}
```

::tip
Use `campaign_data` to pass dynamic variables that can be used in your WhatsApp templates.
::

## 4. Real-time Status Sync

Configure your system to listen for `ticket.updated` events.

**Event**: `ticket.updated`

```json
{
  "event": "ticket.updated",
  "data": {
    "id": "hashed_ticket_id",
    "external_id": "ORDER-12345",
    "ticket_status_id": "new_status_id",
    "changes": {
      "ticket_status_id": "new_status_id"
    }
  }
}
```

## 5. Entity Management (Thirds)

Manage your customer profiles (Thirds) to sync contact details.

| Endpoint            | Method  | Description                        |
| :------------------ | :------ | :--------------------------------- |
| `/v1/thirds`        | `POST`  | Create a new customer profile.     |
| `/v1/thirds/{id}`   | `PATCH` | Update an existing profile.        |
| `/v1/thirds/import` | `POST`  | Bulk import contacts via CSV/JSON. |

### Assigning Tags for Campaigns

Tag users to segment them for marketing campaigns (e.g., "VIP", "Newsletter").

```json
{
  "tags": ["vip_customer", "newsletter_subscribed"]
}
```
