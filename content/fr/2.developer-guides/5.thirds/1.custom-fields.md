---
title: Champs Personnalisés
description: Stockez et récupérez des métadonnées personnalisées sur vos entités Third (contacts, clients).
icon: i-lucide-tags
---

Les Champs Personnalisés vous permettent d'étendre vos entités Third avec des métadonnées dynamiques et flexibles. Utilisez-les pour stocker des statistiques, des préférences ou toute donnée personnalisée sur vos contacts.

---

## 1. Définir les Champs Personnalisés

Avant de stocker des données, définissez optionnellement le schéma pour assurer des types de données cohérents.

### Créer une Définition de Champ

::api-playground{method="POST" url="https://api.digishare.ma/v1/custom-field-definitions" description="Créer une nouvelle définition de champ personnalisé." :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}' :body='{"key": "balance", "label": "Solde du Compte", "type": "float"}'}
::

### Paramètres de Définition

| Paramètre | Type   | Requis | Description                                                           |
| --------- | ------ | ------ | --------------------------------------------------------------------- |
| `key`     | string | Oui    | Identifiant unique du champ                                           |
| `label`   | string | Oui    | Nom d'affichage lisible                                               |
| `type`    | string | Oui    | Type de données : `string`, `int`, `float`, `bool`, `date`            |
| `options` | object | Non    | Configuration additionnelle (options de liste déroulante, validation) |

### Types de Données Supportés

| Type     | Description        | Exemple            |
| -------- | ------------------ | ------------------ |
| `string` | Valeurs texte      | `"Client Premium"` |
| `int`    | Nombres entiers    | `42`               |
| `float`  | Nombres décimaux   | `150.75`           |
| `bool`   | Vrai/Faux          | `true`             |
| `date`   | Date au format ISO | `"2026-01-15"`     |

---

## 2. Lister les Définitions

Récupérez toutes les définitions de champs personnalisés :

::api-playground{method="GET" url="https://api.digishare.ma/v1/custom-field-definitions" description="Lister toutes les définitions de champs personnalisés." :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}'}
::

### Exemple de Réponse

```json
{
  "data": [
    {
      "key": "balance",
      "label": "Solde du Compte",
      "type": "float"
    },
    {
      "key": "order_count",
      "label": "Total des Commandes",
      "type": "int"
    }
  ]
}
```

---

## 3. Définir les Valeurs

Stockez des données personnalisées sur une entité Third :

::api-playground{method="POST" url="https://api.digishare.ma/v1/thirds/{hashed_id}/custom-fields" description="Mettre à jour les champs personnalisés pour un Third." :variables='{"hashed_id": "YOUR_THIRD_ID", "token": "YOUR_ACCESS_TOKEN"}' :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}' :body='{"fields": {"balance": 150.75, "order_count": 12, "is_vip": true}}'}
::

::note
**Comportement de fusion :** Cet endpoint **fusionne** les champs fournis avec les données existantes. Les champs non inclus dans la requête restent inchangés. Pour supprimer un champ, utilisez l'[endpoint de suppression](#5-supprimer-des-champs).
::

### Corps de la Requête

| Paramètre | Type   | Requis | Description                   |
| --------- | ------ | ------ | ----------------------------- |
| `fields`  | object | Oui    | Paires clé-valeur des données |

### Exemple

```bash
POST /v1/thirds/{hashed_id}/custom-fields
Content-Type: application/json

{
  "fields": {
    "balance": 150.75,
    "order_count": 12,
    "is_vip": true,
    "loyalty_tier": "gold"
  }
}
```

---

## 4. Récupérer les Valeurs

Récupérez les champs personnalisés d'un Third :

::api-playground{method="GET" url="https://api.digishare.ma/v1/thirds/{hashed_id}/custom-fields" description="Récupérer tous les champs personnalisés d'un Third." :variables='{"hashed_id": "YOUR_THIRD_ID", "token": "YOUR_ACCESS_TOKEN"}' :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}'}
::

### Exemple de Réponse

```json
{
  "data": {
    "balance": 150.75,
    "order_count": 12,
    "is_vip": true,
    "loyalty_tier": "gold"
  }
}
```

---

## 5. Supprimer des Champs

Supprimez des champs personnalisés d'un Third :

::api-playground{method="DELETE" url="https://api.digishare.ma/v1/thirds/{hashed_id}/custom-fields" description="Supprimer des champs personnalisés d'un Third." :variables='{"hashed_id": "YOUR_THIRD_ID", "token": "YOUR_ACCESS_TOKEN"}' :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}' :body='{"keys": ["balance", "order_count"]}'}
::

### Supprimer des Champs Spécifiques

```bash
DELETE /v1/thirds/{hashed_id}/custom-fields
Content-Type: application/json

{
  "keys": ["balance", "order_count"]
}
```

---

## Cas d'Utilisation

::card-group
::card{title="Stats Client" icon="i-lucide-bar-chart-2"}
Suivez le nombre de commandes, la valeur à vie et la fréquence d'achat pour chaque client.
::

::card{title="Préférences" icon="i-lucide-settings"}
Stockez les abonnements newsletter, les préférences linguistiques et les paramètres de notification.
::

::card{title="Intégration CRM" icon="i-lucide-link"}
Synchronisez les données CRM externes comme les scores de leads, les étapes de pipeline ou les identifiants personnalisés.
::

::card{title="Analytics" icon="i-lucide-trending-up"}
Stockez des métriques calculées comme les scores d'engagement ou les indicateurs de risque de churn.
::
::

::tip
**Bonne Pratique :** Définissez vos champs en premier via l'API de Définitions. Cela garantit des types de données cohérents et améliore les performances de filtrage/tri.
::
