---
title: Messages sortants
description: Référence détaillée pour l'envoi de textes, de localisations et de messages interactifs via l'API.
icon: i-lucide-send
---

::warning
**Prérequis** : Vous devez disposer d'un ID de conversation actif pour répondre à un utilisateur. Voir [Intégration LiveChat](/developer-guides/livechat/integration).
::

## 1. Enveloppe du message

Chaque requête API utilise cette structure standard.

| Champ             | Type          | Description                                                              |
| :---------------- | :------------ | :----------------------------------------------------------------------- |
| `send_to_third`   | Boolean       | Réglez sur `true` pour livrer via une plateforme externe (ex: WhatsApp). |
| `conversation_id` | String        | Identifiant unique de la session de chat.                                |
| `type`            | String        | Format du message : `text`, `location` ou `interactive`.                 |
| `body`            | String/Object | Le contenu (varie selon le type).                                        |

## 2. Message texte

Communication textuelle simple. Le `body` est une **chaîne de caractères**.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "send_to_third": true,
    "conversation_id": "ID_DE_VOTRE_CONVERSATION",
    "type": "text",
    "body": "Bonjour Adil ! Votre commande est prête."
  }'
```

::

## 3. Message de localisation

Envoyez un point sur une carte statique.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "send_to_third": true,
    "conversation_id": "ID_DE_VOTRE_CONVERSATION",
    "type": "location",
    "body": {
      "latitude": 33.5731,
      "longitude": -7.5898,
      "name": "Siège Digishare",
      "address": "Casablanca, Maroc"
    }
  }'
```

::

## 4. Messages interactifs

Messages structurés pour un engagement accru.

::accordion
::accordion-item{label="Boutons de réponse" icon="i-lucide-mouse-pointer-2"}
Idéal pour les confirmations rapides (Oui/Non). Maximum 3 boutons.

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "interactive",
    "body": {
      "type": "button",
      "header": { "type": "text", "text": "Confirmation" },
      "body": { "text": "Confirmez-vous la réception ?" },
      "action": {
        "buttons": [
          { "type": "reply", "reply": { "id": "btn_oui", "title": "Oui" } },
          { "type": "reply", "reply": { "id": "btn_non", "title": "Non" } }
        ]
      }
    }
  }'
```

::

::accordion-item{label="Menu liste" icon="i-lucide-list"}
Idéal pour plusieurs options (jusqu'à 10 lignes).

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "interactive",
    "body": {
      "type": "list",
      "header": { "type": "text", "text": "Menu Support" },
      "body": { "text": "Choisissez une catégorie ci-dessous :" },
      "action": {
        "button": "Sélectionner",
        "sections": [
          {
            "title": "Support Technique",
            "rows": [
              {
                "id": "ligne_1",
                "title": "Problèmes API",
                "description": "Aide à l'intégration"
              },
              { "id": "ligne_2", "title": "Connexion", "description": "Accès au compte" }
            ]
          }
        ]
      }
    }
  }'
```

::

::accordion-item{label="Demande de localisation" icon="i-lucide-map-pin"}
Déclenche l'interface native "Envoyer la localisation".

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messages \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "type": "interactive",
    "body": {
      "type": "location_request_message",
      "body": { "text": "Veuillez partager votre position actuelle." },
      "action": { "name": "send_location" }
    }
  }'
```

::
::

## 5. Contraintes

| Type           | Composant          | Limite          |
| :------------- | :----------------- | :-------------- |
| **Texte**      | `body`             | 4096 Caractères |
| **Interactif** | `header`           | 60 Caractères   |
| **Interactif** | titre `button`     | 20 Caractères   |
| **Interactif** | titre ligne `list` | 24 Caractères   |
