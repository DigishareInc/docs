---
title: Campagnes WhatsApp
description: Orchestrez des campagnes WhatsApp à haut volume en utilisant des modèles de messages.
icon: i-lucide-smartphone
---

Ce guide montre comment envoyer une campagne WhatsApp à l'aide de modèles pré-approuvés. C'est la méthode standard pour les diffusions à haut volume et les notifications marketing.

::note
**Prérequis** :

- **Jeton Bearer** valide
- **ID de modèle de message** approuvé (ex: `VOTRE_ID_MODELE`)
- **ID de label d'expéditeur** (ex: `VOTRE_ID_EXPEDITEUR`) représentant votre canal WhatsApp.
  ::

## 1. Structure du Payload

Pour envoyer une campagne, vous effectuez une requête POST vers `/v1/campaigns` avec un corps JSON.

### Variables communes

- `title` : Un nom pour la campagne (pour le suivi interne).
- `contacts_and_data` : Contient la configuration du message et la liste des destinataires.
- `_` : (À l'intérieur de `contacts_and_data`) Configuration globale de la campagne.
  - `channel` : `whatsapp`
  - `sender_label_id` : L'ID de votre canal d'envoi.
  - `message_template_id` : L'ID du modèle que vous souhaitez envoyer.

## 2. Exemple : Modèle standard

Si votre modèle est un simple message texte avec des variables comme `Bonjour {{1}}, votre commande {{2}} est prête.`, le payload ressemblerait à ceci :

::code-group

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/campaigns \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Campagne de Bienvenue",
    "contacts_and_data": {
      "_": {
        "channel": "whatsapp",
        "sender_label_id": "VOTRE_ID_EXPEDITEUR",
        "message_template_id": "VOTRE_ID_MODELE"
      },
      "contacts": [
        {
          "wa_id": "212600000000",
          "data": {
            "1": "John",
            "2": "ORD-123"
          }
        },
        {
          "wa_id": "212600000001",
          "data": {
            "1": "Jane",
            "2": "ORD-456"
          }
        }
      ]
    }
  }'
```

::

## 3. Variables dynamiques

Les modèles WhatsApp standards utilisent souvent des variables numérotées (`{{1}}`, `{{2}}`). Dans votre liste `contacts`, vous fournissez ces valeurs dans l'objet `data` pour chaque destinataire.

::tip
Assurez-vous toujours que le nombre de variables dans votre objet `data` correspond aux variables attendues dans votre modèle approuvé pour éviter les échecs de livraison.
::

## 4. Planification (Optionnel)

Vous pouvez planifier une campagne pour le futur en ajoutant une propriété `start_datetime` (au format ISO 8601) au payload de premier niveau.

```json
{
  "title": "Campagne Planifiée",
  "start_datetime": "2025-06-01T10:00:00Z",
  "contacts_and_data": { ... }
}
```
