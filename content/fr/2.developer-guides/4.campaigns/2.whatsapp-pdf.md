---
title: Campagnes WhatsApp (PDF)
description: Orchestrez des campagnes WhatsApp à haut volume avec des pièces jointes PDF dynamiques.
icon: i-lucide-megaphone
---

Ce guide montre comment envoyer une campagne WhatsApp avec une pièce jointe PDF.

::note
**Prérequis** :

- **Jeton Bearer** valide
- **ID de modèle de message** approuvé (ex: `VOTRE_ID_MODELE`)
- **ID de label d'expéditeur** (ex: `VOTRE_ID_EXPEDITEUR`)
  ::

## Méthode 1 : Base64 incorporé

Envoyez un fichier directement dans le payload sans import préalable. Idéal pour les fichiers uniques générés à la volée.

::steps

### Encoder le PDF

Convertissez votre fichier PDF en une chaîne Base64.

### Construire le Payload

Ajoutez la chaîne encodée à l'objet `base64_files`.

### Envoyer la demande

La clé utilisée dans `base64_files` (ex : `facture_file_123`) doit correspondre à l'ID de la variable d'en-tête (header).
::

::code-group

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/campaigns \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Campagne Facturation",
    "message_template_id": "VOTRE_ID_MODELE",
    "base64_files": {
      "VOTRE_CLE_MAPPING_FICHIER": {
        "base64": "data:application/pdf;base64,JVBERi0xLjQKJ...",
        "file_name": "facture",
        "mime_type": "application/pdf",
        "extension": "pdf"
      }
    },
    "contacts_and_data": {
      "data": {
        "header": { "id": "VOTRE_CLE_MAPPING_FICHIER" },
        "wa_id": "%recipient.wa_id%"
      },
      "contacts": [
        { "wa_id": "212600000000" }
      ]
    }
  }'
```

::

## Méthode 2 : Import en deux étapes

Téléchargez d'abord le fichier pour obtenir un `media_id`, puis utilisez cet ID dans votre campagne. Mieux pour les fichiers volumineux ou les ressources réutilisées.

::tip
Utilisez la **méthode incorporée** pour les petits PDF et la **méthode en deux étapes** pour les fichiers plus volumineux afin d'assurer de meilleures performances.
::

::steps

### Télécharger le fichier

Effectuez une requête POST vers `/messagesTemplates` avec le contenu de votre fichier. Enregistrez l' `id` retourné.

### Envoyer la campagne

Utilisez l' `id` retourné dans le champ `header.id` du payload de votre campagne.
::

### Étape 1 : Import

::code-group

```bash [Requête d'import]
curl -X POST https://api.digishare.ma/v1/messagesTemplates \
  -H "Authorization: Bearer VOTRE_JETON" \
  -d '{
    "type": "file",
    "category": "document",
    "file": {
      "base64": "...",
      "file_name": "facture",
      "mime_type": "application/pdf"
    }
  }'
```

::

### Étape 2 : Envoi

```bash [Requête d'envoi]
curl -X POST https://api.digishare.ma/v1/campaigns \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Campagne Facturation",
    "contacts_and_data": {
      "data": {
        "header": {
          "id": "MEDIA_ID_DE_L_ETAPE_1"
        }
      }
    }
  }'
```
