---
title: Int√©gration E-Commerce
description: Automatisez les notifications de commande et les tickets de support pour votre boutique en ligne.
icon: i-lucide-shopping-cart
---

Ce document d√©crit le flux de travail pour int√©grer une **application eCommerce** avec la plateforme Digishare. Cela permet le support client automatis√© et les notifications de commande.

::note
**Pr√©requis** : Assurez-vous d'avoir authentifi√© votre client. Voir [Authentification](/developer-guides/authentication).
::

## 1. Vue d'ensemble du Flux

::steps

### T√©l√©charger le M√©dia

(Optionnel) T√©l√©chargez tous les fichiers n√©cessaires (PDFs, Images) pour obtenir leurs IDs.

### Cr√©ation de Ticket

Votre application eCommerce cr√©e un ticket lorsqu'un probl√®me de commande survient ou qu'une confirmation est n√©cessaire.

### Notification Automatis√©e

Digishare d√©clenche automatiquement une notification WhatsApp au client.

### Synchronisation Webhook

Digishare notifie votre application eCommerce via webhook pour mettre √† jour le statut de la commande.
::

## 2. T√©l√©charger le M√©dia

**Point de terminaison** : `POST https://api.digishare.ma/v1/messagesTemplates`

Avant de cr√©er un ticket avec une pi√®ce jointe (comme une facture PDF), vous devez t√©l√©charger le fichier sur Digishare pour obtenir un `media_id`.

::api-playground{method="POST" url="https://api.digishare.ma/v1/messagesTemplates" description="T√©l√©chargez un fichier (PDF, image) pour obtenir un media_id √† utiliser dans les tickets." :variables='{"token": "VOTRE_TOKEN"}' :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}' :body='{"type": "file", "category": "document", "file": {"base64": "data:application/pdf;base64,JVBERi0xLjQKJ...", "file_name": "facture", "mime_type": "application/pdf"}}'}
::

> **R√©ponse** : Enregistrez l'`id` retourn√© (par ex., `VOTRE_MEDIA_ID`). Utilisez-le comme `PRE_UPLOADED_HASHED_ID` √† l'√©tape suivante.

## 3. Cr√©ation de Tickets

**Point de terminaison** : `POST https://api.digishare.ma/v1/tickets`

Cr√©ez un ticket pour initier le flux de support. Vous pouvez mapper des IDs externes (comme l'ID de commande) au ticket.

::api-playground{method="POST" url="https://api.digishare.ma/v1/tickets" description="Cr√©ez un ticket de support pour la confirmation de commande ou les probl√®mes clients." :variables='{"token": "VOTRE_TOKEN", "mediaId": "PRE_UPLOADED_HASHED_ID"}' :headers='{"Authorization": "Bearer {token}", "Content-Type": "application/json"}' :body='{"external_id": "COMMANDE-12345", "type_ticket_id": "npvrxamq9l94y8dz", "ticket_status_id": "x9q3wrlv0m7vzea8", "create_third_data": true, "information": {"third": {"ext_ref": "CLIENT-67890", "name": "Ahmed Alami", "wa_id": "212600000000", "email": "ahmed.alami@example.com"}, "campaign_data": {"order_id": "12345", "invoice_document": {"provider": "digishare", "id": "{mediaId}"}, "items_count": "5", "order_total": "500.00", "delivery_address": "Casablanca, Bd Zerktouni"}}, "subject": "Confirmation de Commande", "lang": "fr"}'}
::

::tip
Utilisez `campaign_data` pour passer des variables dynamiques qui peuvent √™tre utilis√©es dans vos mod√®les WhatsApp.
::

## 4. Synchronisation de Statut en Temps R√©el

Configurez votre syst√®me pour √©couter les √©v√©nements `ticket.updated`.

**√âv√©nement** : `ticket.updated`

```json
{
  "event": "ticket.updated",
  "data": {
    "id": "hashed_ticket_id",
    "data": {
      "id": "hashed_ticket_id",
      "external_id": "COMMANDE-12345",
      "subject": "Confirmation de Commande",
      "ticket_number": "342106",
      "type_ticket_id": "npvrxamq9l94y8dz",
      "third_id": "hashed_third_id",
      "ticket_status_id": "yqdwrbka7kz69v8e",
      "information": {
        "third": {
          "name": "Ahmed Alami",
          "email": "ahmed.alami@example.com",
          "wa_id": "212600000000",
          "ext_ref": "CLIENT-67890"
        },
        "campaign_data": {
          "...": "..."
        }
      },
      "...": "..."
    },
    "wasRecentlyCreated": false,
    "changes": {
      "date_demand": "2026-01-13 17:27:00",
      "date_status": "2026-01-13 16:29:51",
      "ticket_status_id": "yqdwrbka7kz69v8e",
      "updated_at": "2026-01-13 16:29:51"
    }
  }
}
```

::tip
Le `ticket_status_id`: `yqdwrbka7kz69v8e` correspond au statut **Commande Confirm√©e**.
::

## 5. Gestion des Entit√©s (Tiers)

G√©rez vos profils clients (Tiers) pour synchroniser les d√©tails de contact.

::callout{type="warning"}
üöß **Bient√¥t Disponible** : Cette documentation est actuellement en d√©veloppement.
::
