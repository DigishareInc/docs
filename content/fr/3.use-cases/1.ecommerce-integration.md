---
title: Int√©gration E-Commerce
description: Automatisez les notifications de commande et les tickets de support pour votre boutique en ligne.
icon: i-lucide-shopping-cart
---

Ce document d√©crit le flux de travail pour l'int√©gration d'une **application e-commerce** avec la plateforme Digishare. Cela permet un support client automatis√© et des notifications de commande.

::note
**Pr√©requis** : Assurez-vous d'avoir authentifi√© votre client. Voir [Authentification](/developer-guides/authentication).
::

## 1. Aper√ßu du flux de travail

::steps

### Import de M√©dias

(Facultatif) T√©l√©chargez les fichiers n√©cessaires (PDF, images) pour obtenir leurs identifiants.

### Cr√©ation de Ticket

Votre application e-commerce cr√©e un ticket lorsqu'un probl√®me de commande survient ou qu'une confirmation est n√©cessaire.

### Notification Automatis√©e

Digishare d√©clenche automatiquement une notification WhatsApp vers le client.

### Synchronisation Webhook

Digishare informe votre application e-commerce via un webhook pour mettre √† jour le statut de la commande.
::

## 2. Import de M√©dias

**Point de terminaison** : `POST https://api.digishare.ma/v1/messagesTemplates`

Avant de cr√©er un ticket avec une pi√®ce jointe (comme une facture PDF), vous devez t√©l√©charger le fichier sur Digishare pour obtenir un `media_id`.

::code-group

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/messagesTemplates \
  -H "Authorization: Bearer VOTRE_JETON" \
  -d '{
    "type": "file",
    "category": "document",
    "file": {
      "base64": "data:application/pdf;base64,JVBERi0xLjQKJ...",
      "file_name": "facture",
      "mime_type": "application/pdf"
    }
  }'
```

::

> **R√©ponse** : Enregistrez l' `id` retourn√© (ex: `VOTRE_MEDIA_ID`). Utilisez-le comme `PRE_UPLOADED_HASHED_ID` √† l'√©tape suivante.

## 3. Cr√©ation de Tickets

**Point de terminaison** : `POST https://api.digishare.ma/v1/tickets`

Cr√©ez un ticket pour lancer le flux de support. Vous pouvez mapper des identifiants externes (comme l'ID de commande) au ticket.

### Corps de la requ√™te

::code-group

```bash [cURL]
curl -X POST https://api.digishare.ma/v1/tickets \
  -H "Authorization: Bearer VOTRE_JETON" \
  -H "Content-Type: application/json" \
  -d '{
  "external_id": "COMMANDE-12345",
  "type_ticket_id": "npvrxamq9l94y8dz",
  "ticket_status_id": "x9q3wrlv0m7vzea8",
  "create_third_data": true,
  "information": {
    "third": {
      "ext_ref": "CLIENT-67890",
      "name": "Ahmed Alami",
      "wa_id": "212600000000",
      "email": "ahmed.alami@example.com"
    },
    "campaign_data": {
      "order_id": "12345",
      "invoice_document": {
        "provider": "digishare",
        "id": "PRE_UPLOADED_HASHED_ID"
      },
      "items_count": "5",
      "order_total": "500.00",
      "delivery_address": "Casablanca, Bd Zerktouni"
    }
  },
  "subject": "Confirmation de commande",
  "lang": "fr"
}'
```

```json [Payload]
{
  "external_id": "COMMANDE-12345",
  "type_ticket_id": "npvrxamq9l94y8dz",
  "ticket_status_id": "x9q3wrlv0m7vzea8",
  "create_third_data": true,
  "information": {
    "third": {
      "ext_ref": "CLIENT-67890",
      "name": "Ahmed Alami",
      "wa_id": "212600000000",
      "email": "ahmed.alami@example.com"
    },
    "campaign_data": {
      "order_id": "12345",
      "invoice_document": {
        "provider": "digishare",
        "id": "PRE_UPLOADED_HASHED_ID"
      },
      "items_count": "5",
      "order_total": "500.00",
      "delivery_address": "Casablanca, Bd Zerktouni"
    }
  },
  "subject": "Confirmation de commande",
  "lang": "fr"
}
```

::

::tip
Utilisez `campaign_data` pour passer des variables dynamiques qui peuvent √™tre utilis√©es dans vos mod√®les WhatsApp.
::

## 4. Synchronisation du statut en temps r√©el

Configurez votre syst√®me pour √©couter les √©v√©nements `ticket.updated`.

**√âv√©nement** : `ticket.updated`

```json
{
  "event": "ticket.updated",
  "data": {
    "id": "id_ticket_hache",
    "data": {
      "id": "id_ticket_hache",
      "external_id": "COMMANDE-12345",
      "subject": "Confirmation de commande",
      "ticket_number": "342106",
      "type_ticket_id": "npvrxamq9l94y8dz",
      "third_id": "id_tiers_hache",
      "ticket_status_id": "yqdwrbka7kz69v8e",
      "information": {
        "third": {
          "name": "Ahmed Alami",
          "email": "ahmed.alami@example.com",
          "wa_id": "212600000000",
          "ext_ref": "CLIENT-67890"
        },
        "campaign_data": {
          "...": "..."
        }
      },
      "...": "..."
    },
    "wasRecentlyCreated": false,
    "changes": {
      "date_demand": "2026-01-13 17:27:00",
      "date_status": "2026-01-13 16:29:51",
      "ticket_status_id": "yqdwrbka7kz69v8e",
      "updated_at": "2026-01-13 16:29:51"
    }
  }
}
```

::tip
L' `ticket_status_id` : `yqdwrbka7kz69v8e` correspond au statut **Commande Confirm√©e**.
::

## 5. Gestion des entit√©s (Tiers)

G√©rez vos profils clients (Tiers) pour synchroniser les coordonn√©es.

::callout{type="warning"}
üöß **Prochainement** : Cette documentation est actuellement en cours de d√©veloppement.
::
